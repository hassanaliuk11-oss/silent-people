<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual CNIC Copy Maker - Professional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .cnic-card-ui {
            width: 85.6mm;
            height: 53.98mm;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-color: #fff;
            position: relative;
        }
        .cnic-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* Dashboard Styling */
        body { background-color: #1a202c; }
        .page-preview {
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            min-height: 297mm;
            width: 210mm;
            padding: 10mm;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-auto-rows: min-content;
            gap: 5mm;
            align-content: start;
        }
    </style>
</head>
<body class="p-4 flex flex-col items-center">

    <!-- Sticky Header Controls -->
    <div class="w-full max-w-[210mm] bg-white rounded-lg shadow-xl overflow-hidden mb-6 sticky top-0 z-50 border-b-4 border-blue-600">
        <div class="bg-blue-800 p-4 text-white flex justify-between items-center">
            <div>
                <h1 class="font-bold text-lg leading-tight">Manual CNIC Copy Tool</h1>
                <p class="text-[10px] opacity-80">Har card apni marzi se add aur select karein</p>
            </div>
            <div class="flex gap-3">
                <button onclick="addCard()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-sm font-bold shadow-md transition-all active:scale-95">
                    + Add Card
                </button>
                <button onclick="prepareAndPrint()" class="bg-yellow-500 hover:bg-yellow-600 px-5 py-2 rounded text-sm text-black font-extrabold shadow-md transition-all active:scale-95 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                    </svg>
                    PRINT / PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Paper Container -->
    <div id="printArea" class="page-preview">
        <!-- Cards added here -->
    </div>

    <script>
        let cardCount = 0;

        function addCard() {
            cardCount++;
            const cardId = `card-${cardCount}`;
            const cardHTML = `
                <div id="${cardId}" class="flex flex-col items-center border border-gray-100 p-2 rounded hover:bg-gray-50 transition-colors">
                    <div class="cnic-card-ui shadow-sm">
                        <img id="img-${cardId}" src="" class="cnic-img hidden">
                        <span id="label-${cardId}" class="text-gray-300 text-[10px] font-bold italic">No Photo</span>
                    </div>
                    
                    <div class="mt-2 flex items-center justify-between w-full px-1">
                        <input type="file" accept="image/*" onchange="updateImage(event, 'img-${cardId}', 'label-${cardId}')" 
                               class="text-[9px] w-32 file:bg-blue-50 file:border-0 file:rounded file:text-blue-700 file:px-2 file:py-1 cursor-pointer">
                        <button onclick="removeCard('${cardId}')" class="bg-red-100 text-red-600 hover:bg-red-600 hover:text-white w-6 h-6 rounded flex items-center justify-center font-bold text-xs transition-colors">âœ•</button>
                    </div>
                </div>
            `;
            document.getElementById('printArea').insertAdjacentHTML('beforeend', cardHTML);
        }

        function removeCard(id) {
            document.getElementById(id).remove();
        }

        function updateImage(event, imgId, labelId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById(imgId);
                    const label = document.getElementById(labelId);
                    img.src = e.target.result;
                    img.classList.remove('hidden');
                    label.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        function prepareAndPrint() {
            const cards = document.querySelectorAll('.cnic-card-ui');
            if (cards.length === 0) {
                alert("Pehle kam az kam aik card add karein!");
                return;
            }

            // Get all images
            let imagesHtml = '';
            cards.forEach(card => {
                const imgSrc = card.querySelector('img').src;
                if (imgSrc && imgSrc.startsWith('data:image')) {
                    imagesHtml += `<div class="print-card"><img src="${imgSrc}"></div>`;
                } else {
                    imagesHtml += `<div class="print-card" style="border: 1px dashed #ccc; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #999;">Empty Card</div>`;
                }
            });

            // Open new window for clean print
            const printWin = window.open('', '_blank');
            printWin.document.write(`
                <html>
                <head>
                    <title>CNIC Print</title>
                    <style>
                        body { margin: 0; padding: 0; background: white; }
                        .print-page {
                            width: 210mm;
                            height: 297mm;
                            padding: 10mm;
                            box-sizing: border-box;
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            grid-auto-rows: 53.98mm;
                            gap: 5mm;
                        }
                        .print-card {
                            width: 85.6mm;
                            height: 53.98mm;
                            border: 1px solid black;
                            overflow: hidden;
                        }
                        .print-card img {
                            width: 100%;
                            height: 100%;
                            object-fit: cover;
                        }
                        @page { size: A4; margin: 0; }
                    </style>
                </head>
                <body>
                    <div class="print-page">
                        ${imagesHtml}
                    </div>
                    <script>
                        window.onload = function() {
                            window.print();
                            window.onafterprint = function() { window.close(); };
                        };
                    <\/script>
                </body>
                </html>
            `);
            printWin.document.close();
        }

        // Add first card automatically
        window.onload = addCard;
    </script>
</body>
</html>
